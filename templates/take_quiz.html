<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Take Quiz</title>
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
  <script>
    function startTimer(totalSeconds) {
      const el = document.getElementById('timer');
      let s = totalSeconds;
      const iv = setInterval(() => {
        if (s <= 0) {
          clearInterval(iv);
          document.getElementById('quizForm').submit();
          return;
        }
        const m = Math.floor(s/60);
        const sec = s % 60;
        el.textContent = `${m}:${sec.toString().padStart(2,'0')}`;
        s--;
      }, 1000);
    }
    window.addEventListener('load', () => {
      const count = parseInt(document.getElementById('qcount').value || "1");
      startTimer(count * 60);
    });
  </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 text-white p-6">
  <div class="max-w-3xl mx-auto bg-black bg-opacity-40 p-6 rounded-lg">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">Take Quiz</h1>
      <div>Time left: <span id="timer">--:--</span></div>
    </div>

    <form id="quizForm" method="POST">
      <input type="hidden" id="qcount" value="{{ quiz|length }}">
      {% for q in quiz %}
        <div class="mb-4 p-3 bg-gray-800 rounded">
          <div class="font-semibold">{{ loop.index }}. {{ q.question }}</div>
          <div class="mt-2 space-y-1">
            {% for opt in q.options %}
              <label class="block">
                <input required type="radio" name="q{{ loop.index0 }}" value="{{ ['A','B','C','D'][loop.index0] }}">
                {{ ['A','B','C','D'][loop.index0] }}. {{ opt }}
              </label>
            {% endfor %}
          </div>
        </div>
      {% endfor %}

      <div class="flex gap-3">
        <button type="submit" class="px-4 py-2 rounded bg-green-600">Submit</button>
        <a href="{{ url_for('view_quiz') }}" class="px-4 py-2 rounded bg-gray-700">Preview</a>
      </div>
    </form>
  </div>
</body>
</html>
